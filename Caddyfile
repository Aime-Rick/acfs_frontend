:80 {
	# Set the root to the dist directory
	root * /srv

	# Enable gzip compression
	encode gzip zstd

	# Security headers
	header {
		# Enable HSTS
		Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
		# Prevent clickjacking
		X-Frame-Options "SAMEORIGIN"
		# Prevent MIME type sniffing
		X-Content-Type-Options "nosniff"
		# Enable XSS protection
		X-XSS-Protection "1; mode=block"
		# Referrer policy
		Referrer-Policy "strict-origin-when-cross-origin"
		# Remove Server header
		-Server
	}

	# Cache static assets
	@static {
		path *.js *.css *.png *.jpg *.jpeg *.gif *.ico *.svg *.woff *.woff2 *.ttf *.eot *.webp
	}
	header @static {
		Cache-Control "public, max-age=31536000, immutable"
	}

	# Don't cache HTML files
	@html {
		path *.html /
	}
	header @html {
		Cache-Control "no-cache, no-store, must-revalidate"
	}

	# Try to serve the file, otherwise serve index.html (SPA routing)
	try_files {path} /index.html

	# Serve static files
	file_server
	
	# Logging
	log {
		output stdout
		format json
		level INFO
	}
}

